<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover">
  <meta name="description" content="PagCerto - Calculadora financeira premium para comparar pagamento à vista versus parcelado com inteligência">
  <title>PagCerto | Calculadora Financeira Inteligente</title>
  <!-- Google Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <link rel="icon" href="favicon.png" type="image/png">
  <meta name="theme-color" content="#1e40af">
  
  <style>
    :root {
      --color-bg: #f7f9fc;
      --color-card: #ffffff;
      --color-primary: #1e40af;
      --color-primary-light: #3b82f6;
      --color-primary-dark: #1e3a8a;
      --color-secondary: #FFB400;
      --color-secondary-dark: #e09600;
      --color-text: #1f2937;
      --color-text-light: #6b7280;
      --color-border: #e5e7eb;
      --color-success: #10b981;
      --color-error: #ef4444;
      --border-radius: 14px;
      --box-shadow: 0 10px 25px -5px rgba(0,0,0,0.05), 0 8px 10px -6px rgba(0,0,0,0.01);
      --box-shadow-hover: 0 20px 35px -10px rgba(0,0,0,0.08), 0 10px 20px -10px rgba(0,0,0,0.04);
      --field-height: 3.25rem;
      --logo-size: 90px;
      --input-padding: 0.875rem;
      --transition: all 0.3s ease;
    }
    
    * { 
      box-sizing: border-box; 
      margin: 0;
      padding: 0;
    }
    
    body { 
      margin: 0; 
      padding: 0; 
      background: var(--color-bg); 
      color: var(--color-text); 
      font-family: 'Roboto', sans-serif;
      line-height: 1.6;
      min-height: 100vh;
      padding-bottom: 3rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    /* Cabeçalho premium */
    header {
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
      padding: 3rem 1rem 6rem;
      margin-bottom: -2rem;
      box-shadow: var(--box-shadow);
      position: relative;
      overflow: hidden;
    }
    
    .header-wave {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100px;
      overflow: hidden;
    }
    
    .header-wave svg {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    .header-wave path {
      fill: var(--color-bg);
    }
    
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 1;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    
    .logo-wrapper {
      position: relative;
      width: var(--logo-size);
      height: var(--logo-size);
    }
    
    .logo {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2));
      position: relative;
      z-index: 2;
    }
    
    .logo-glow {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(255,180,0,0.4) 0%, rgba(255,180,0,0) 70%);
      border-radius: 50%;
      animation: pulse 3s infinite;
      z-index: 1;
    }
    
    @keyframes pulse {
      0% { transform: scale(0.95); opacity: 0.7; }
      50% { transform: scale(1.05); opacity: 0.9; }
      100% { transform: scale(0.95); opacity: 0.7; }
    }
    
    .brand-text {
      color: white;
    }
    
    .brand-text h1 {
      font-family: 'Poppins', sans-serif;
      font-size: 2.2rem;
      font-weight: 700;
      margin: 0;
      letter-spacing: -0.02em;
    }
    
    .brand-text h1 span {
      color: var(--color-secondary);
    }
    
    .brand-text p {
      font-size: 1rem;
      font-weight: 300;
      opacity: 0.9;
      margin: 0;
    }
    
    .header-actions {
      display: flex;
      gap: 1rem;
    }
    
    .header-btn {
      background: rgba(255,255,255,0.15);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 2rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .header-btn:hover {
      background: rgba(255,255,255,0.25);
      transform: translateY(-2px);
    }
    
    .premium-btn {
      background: linear-gradient(135deg, #FFB400, #FF8C00) !important;
      font-weight: 600 !important;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    /* Cartões premium */
    .card {
      background: var(--color-card);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      padding: 2rem;
      margin: 1.5rem auto;
      transition: var(--transition);
      max-width: 1200px;
      position: relative;
      border: 1px solid var(--color-border);
      overflow: hidden;
    }
    
    .card::after {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 30px;
      height: 30px;
      background: linear-gradient(135deg, transparent 0%, transparent 50%, var(--color-primary-light) 50%, var(--color-primary) 100%);
    }
    
    .card:hover {
      box-shadow: var(--box-shadow-hover);
    }
    
    .card-title {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--color-border);
    }
    
    .card-title i {
      background: var(--color-primary-light);
      color: white;
      width: 2.5rem;
      height: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    
    h2 {
      font-family: 'Poppins', sans-serif;
      font-size: 1.35rem;
      margin: 0;
      color: var(--color-primary-dark);
      font-weight: 600;
    }
    
    .form-row { 
      display: flex; 
      flex-wrap: wrap; 
      gap: 1.25rem; 
      margin-bottom: 1rem;
    }
    
    .form-row > label { 
      flex: 1 1 100%; 
    }
    
    @media (min-width: 640px) {
      .form-row > label { 
        flex: 1 1 calc(50% - 0.625rem); 
      }
    }
    
    @media (min-width: 992px) {
      .form-row > label { 
        flex: 1 1 calc(33.333% - 0.835rem); 
      }
    }
    
    label {
      display: flex;
      flex-direction: column;
      font-size: 0.95rem;
      color: var(--color-primary-dark);
      font-weight: 500;
    }
    
    label > span {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.5rem;
    }
    
    label .material-icons-round { 
      font-size: 1.25rem;
      color: var(--color-primary-light);
    }

    /* Input group com prefix/suffix */
    .input-group {
      display: flex;
      align-items: center;
      border: 1px solid var(--color-border);
      border-radius: 12px;
      height: var(--field-height);
      width: 100%;
      padding: 0 1rem;
      background: var(--color-card);
      transition: all 0.2s ease;
      overflow: hidden;
    }
    
    .input-group:focus-within {
      border-color: var(--color-primary-light);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    
    .input-group input {
      border: none;
      outline: none;
      height: 100%;
      flex: 1;
      padding: 0;
      font-size: 1rem;
      font-family: 'Roboto', sans-serif;
      color: var(--color-text);
    }
    
    .input-group input::placeholder {
      color: #a0aec0;
      font-weight: 300;
    }
    
    .input-group .prefix,
    .input-group .suffix {
      font-weight: 500;
      color: var(--color-text-light);
      padding: 0 0.5rem;
    }

    /* Select e botão */
    select {
      height: var(--field-height);
      width: 100%;
      font-size: 1rem;
      border: 1px solid var(--color-border);
      border-radius: 12px;
      padding: 0 1rem;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 1rem;
      color: var(--color-text);
      transition: all 0.2s ease;
      cursor: pointer;
      font-family: 'Roboto', sans-serif;
    }
    
    select:focus {
      outline: none;
      border-color: var(--color-primary-light);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    
    button {
      height: var(--field-height);
      width: 100%;
      font-size: 1rem;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
      font-family: 'Poppins', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      letter-spacing: 0.02em;
    }
    
    .btn-primary {
      background: var(--color-primary);
      color: white;
      border: none;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }
    
    .btn-primary:hover {
      background: var(--color-primary-dark);
      transform: translateY(-2px);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.15), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    .btn-primary:active {
      transform: translateY(1px);
    }
    
    .btn-outline {
      background: transparent;
      color: var(--color-primary);
      border: 2px solid var(--color-primary-light);
    }
    
    .btn-outline:hover {
      background: var(--color-primary-light);
      color: white;
    }
    
    .action-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1.5rem;
    }
    
    .action-row button {
      flex: 1;
    }
    
    .small { 
      font-size: 0.85rem; 
      color: var(--color-text-light); 
      margin: 0.75rem 0 1.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .small .badge {
      background: rgba(59, 130, 246, 0.1);
      color: var(--color-primary-light);
      padding: 0.25rem 0.75rem;
      border-radius: 2rem;
      font-weight: 500;
    }
    
    .loading {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 0.8s linear infinite;
      margin-right: 0.5rem;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Resultados premium */
    .result {
      padding: 0.5rem 0;
    }
    
    .result-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 0;
      border-bottom: 1px solid var(--color-border);
    }
    
    .result-row:last-child {
      border-bottom: none;
    }
    
    .result-label {
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .result-value {
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--color-primary-dark);
    }
    
    .recommendation {
      background: linear-gradient(135deg, var(--color-primary-light), var(--color-primary));
      color: white;
      padding: 1.25rem;
      border-radius: 12px;
      margin-top: 1.5rem;
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .recommendation i {
      font-size: 2rem;
    }
    
    .recommendation-text {
      flex: 1;
    }
    
    .recommendation-text h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 1.2rem;
      margin: 0 0 0.25rem;
    }
    
    .recommendation-text p {
      margin: 0;
      opacity: 0.9;
      font-size: 0.95rem;
    }
    
    .error { 
      color: var(--color-error); 
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 1rem;
      background: rgba(239, 68, 68, 0.1);
      border-radius: 8px;
      margin: 1rem 0;
    }
    
    .hidden { 
      display: none !important; 
    }

    /* Gráficos premium */
    .chart-container {
      min-height: 360px;
      padding: 1rem 0;
      position: relative;
    }
    
    #chart-line, #chart-bar, #chart-donut {
      max-width: 100%;
      opacity: 0;
      animation: fadeIn 0.8s 0.2s forwards;
    }
    
    @keyframes fadeIn { 
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); } 
    }
    
    /* Anúncios premium */
    .ad-container {
      margin: 2rem auto;
      padding: 1.5rem;
      background: linear-gradient(135deg, #f7f9fc, #e6f0ff);
      border-radius: var(--border-radius);
      text-align: center;
      box-shadow: 0 5px 15px rgba(0,0,0,0.03);
    }
    
    .ad-label {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      text-transform: uppercase;
      color: var(--color-primary);
      font-weight: 700;
      letter-spacing: 0.05em;
      margin-bottom: 0.75rem;
    }
    
    .ad-slot {
      min-height: 90px;
      background: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-text-light);
    }
    
    .ad-placeholder {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      width: 100%;
      height: 100%;
      color: var(--color-primary);
      font-weight: 500;
    }
    
    /* CTA de monetização */
    .cta-card {
      display: flex;
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
      color: white;
      border-radius: var(--border-radius);
      overflow: hidden;
      margin: 2rem auto;
      max-width: 1200px;
    }
    
    .cta-content {
      flex: 1;
      padding: 2rem;
    }
    
    .cta-content h3 {
      font-family: 'Poppins', sans-serif;
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }
    
    .cta-content p {
      opacity: 0.9;
    }
    
    .cta-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      background: rgba(255,255,255,0.1);
      font-size: 3rem;
    }
    
    .cta-btn {
      background: white;
      color: var(--color-primary);
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-weight: 600;
      margin-top: 1rem;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .cta-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 10px rgba(0,0,0,0.1);
    }

    /* Footer premium */
    footer {
      margin-top: 3rem;
      padding: 3rem 0 2rem;
      background: var(--color-primary-dark);
      color: white;
      text-align: center;
      border-top-left-radius: 30px;
      border-top-right-radius: 30px;
      position: relative;
      overflow: hidden;
    }
    
    footer::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at top right, rgba(255,180,0,0.1) 0%, transparent 70%);
    }
    
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
      position: relative;
      z-index: 1;
    }
    
    .footer-links {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin: 1.5rem 0;
      flex-wrap: wrap;
    }
    
    .footer-links a {
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      font-size: 0.9rem;
      transition: var(--transition);
      position: relative;
    }
    
    .footer-links a:hover {
      color: white;
    }
    
    .footer-links a::after {
      content: "";
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 0;
      height: 1px;
      background: white;
      transition: var(--transition);
    }
    
    .footer-links a:hover::after {
      width: 100%;
    }
    
    .copyright {
      font-size: 0.85rem;
      opacity: 0.7;
      margin-top: 2rem;
    }
    
    /* Responsividade premium */
    @media (max-width: 768px) {
      header {
        padding: 2rem 1rem 4rem;
      }
      
      .brand-text h1 {
        font-size: 1.8rem;
      }
      
      .header-actions {
        display: none;
      }
      
      .recommendation {
        flex-direction: column;
        text-align: center;
        padding: 1.5rem;
      }
      
      .cta-card {
        flex-direction: column;
      }
      
      .cta-icon {
        display: none;
      }
    }
    
    @media (max-width: 640px) {
      .brand {
        flex-direction: column;
        text-align: center;
      }
      
      .card {
        padding: 1.5rem;
      }
      
      .form-row {
        gap: 1rem;
      }
      
      .result-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
      }
      
      .result-value {
        align-self: flex-end;
      }
      
      .action-row button {
        flex: 1 1 100%;
      }
    }
    
    @media (max-width: 480px) {
      .card {
        padding: 1.25rem;
        margin: 1rem 0;
      }
      
      .brand-text h1 {
        font-size: 1.5rem;
      }
      
      .logo-wrapper {
        width: 60px;
        height: 60px;
      }
      
      .footer-links {
        gap: 1.5rem;
      }
    }
    
    @media (hover: none) {
      button, .header-btn {
        padding: 0.75rem 1.5rem !important;
      }
      
      .input-group, select {
        min-height: 3.5rem !important;
      }
    }
  </style>
</head>
<body>
  <!-- Cabeçalho Premium -->
  <header>
    <div class="header-content">
      <div class="brand">
        <div class="logo-wrapper">
          <img src="favicon.png" alt="PagCerto" class="logo">
          <span class="logo-glow"></span>
        </div>
        <div class="brand-text">
          <h1>Pag<span>Certo</span></h1>
          <p>Sua análise financeira inteligente</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="header-btn premium-btn">
          <i class="material-icons-round">workspace_premium</i>
          Premium
        </button>
      </div>
    </div>
    <div class="header-wave">
      <svg viewBox="0 0 1200 120" preserveAspectRatio="none">
        <path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="#f7f9fc"></path>
        <path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" fill="#f7f9fc"></path>
        <path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="#f7f9fc"></path>
      </svg>
    </div>
  </header>
  
  <div class="container">
    <!-- Ad slot superior premium -->
    <div class="ad-container">
      <div class="ad-label">
        <i class="material-icons-round">spa</i>
        PATROCINADO
      </div>
      <div class="ad-slot" id="adSlotTop">
        <div class="ad-placeholder">
          <i class="material-icons-round">ads_click</i>
          <span>Anúncio de parceiro</span>
        </div>
      </div>
    </div>
    
    <!-- Formulário de entrada premium -->
    <div class="card">
      <div class="card-title">
        <i class="material-icons-round">calculate</i>
        <h2>Calculadora de Parcelas</h2>
      </div>
      
      <div class="form-row">
        <!-- Preço à vista -->
        <label>
          <span><i class="material-icons-round">payments</i>Preço à vista:</span>
          <div class="input-group">
            <span class="prefix">R$</span>
            <input id="v0" type="text" placeholder="1.000,00">
          </div>
        </label>

        <!-- Quantidade de parcelas -->
        <label>
          <span><i class="material-icons-round">date_range</i>Quantidade de parcelas:</span>
          <select id="n_select">
            <option value="">— selecione —</option>
            <option value="1">1x</option><option value="2">2x</option><option value="3">3x</option>
            <option value="4">4x</option><option value="5">5x</option><option value="6">6x</option>
            <option value="7">7x</option><option value="8">8x</option><option value="9">9x</option>
            <option value="10">10x</option><option value="11">11x</option><option value="12">12x</option>
            <option value="other">Outra quantidade</option>
          </select>
        </label>

        <!-- Campo custom para "Outra" -->
        <label id="label_n_custom" class="hidden">
          <span><i class="material-icons-round">edit</i>Digite o número de parcelas:</span>
          <div class="input-group">
            <input id="n_custom" type="text" placeholder="Ex: 18">
          </div>
        </label>
      </div>
      
      <div class="form-row">
        <!-- Valor da parcela -->
        <label>
          <span><i class="material-icons-round">receipt_long</i>Valor da parcela:</span>
          <div class="input-group">
            <span class="prefix">R$</span>
            <input id="p" type="text" placeholder="73,42">
          </div>
        </label>

        <!-- Rendimento CDI -->
        <label>
          <span>
            <i class="material-icons-round">trending_up</i>
            Rendimento (% do CDI):
            <i class="material-icons-round" style="font-size:16px;cursor:help" title="Percentual do CDI que seu investimento rende. 100% significa que rende igual ao CDI.">help_outline</i>
          </span>
          <div class="input-group">
            <input id="cdipercent" type="text" placeholder="100">
            <span class="suffix">%</span>
          </div>
        </label>
      </div>

      <!-- CDI atual -->
      <div class="small">
        <i class="material-icons-round" style="font-size:1.1rem">info</i>
        CDI mensal atual: <span class="badge" id="cdi_valor">—</span>
      </div>
      
      <div class="action-row">
        <button id="btnCalc" class="btn-primary">
          <i class="material-icons-round">calculate</i>
          Calcular
        </button>
        <button id="btnReset" class="btn-outline">
          <i class="material-icons-round">refresh</i>
          Limpar
        </button>
      </div>
    </div>

    <!-- Resultados ocultos inicialmente -->
    <div class="card hidden" id="resCard">
      <div class="card-title">
        <i class="material-icons-round">analytics</i>
        <h2>Resultado da Análise</h2>
      </div>
      
      <div class="result" id="res">
        <!-- Preenchido via JavaScript -->
      </div>
    </div>
    
    <!-- Ad slot meio premium -->
    <div class="ad-container hidden" id="adMiddle">
      <div class="ad-label">
        <i class="material-icons-round">campaign</i>
        RECOMENDAÇÃO
      </div>
      <div class="ad-slot" id="adSlotMiddle">
        <div class="ad-placeholder">
          <i class="material-icons-round">paid</i>
          <span>Anúncio relevante</span>
        </div>
      </div>
    </div>
    
    <div class="card hidden" id="lineCard">
      <div class="card-title">
        <i class="material-icons-round">show_chart</i>
        <h2>Crescimento do Saldo</h2>
      </div>
      <div class="chart-container">
        <div id="chart-line"></div>
      </div>
    </div>
    
    <div class="card hidden" id="barCard">
      <div class="card-title">
        <i class="material-icons-round">bar_chart</i>
        <h2>Comparativo de Custos</h2>
      </div>
      <div class="chart-container">
        <div id="chart-bar"></div>
      </div>
    </div>
    
    <div class="card hidden" id="donutCard">
      <div class="card-title">
        <i class="material-icons-round">pie_chart</i>
        <h2>Composição de Juros</h2>
      </div>
      <div class="chart-container">
        <div id="chart-donut"></div>
      </div>
    </div>
    
    <!-- CTA de Monetização -->
    <div class="cta-card">
      <div class="cta-content">
        <h3>Gostou da ferramenta?</h3>
        <p>Nosso conteúdo é gratuito graças aos nossos anunciantes</p>
        <button class="cta-btn">
          <i class="material-icons-round">volunteer_activism</i>
          Apoie desativando seu adblock
        </button>
      </div>
      <div class="cta-icon">
        <i class="material-icons-round">ads_click</i>
      </div>
    </div>
    
    <!-- Ad slot inferior premium -->
    <div class="ad-container hidden" id="adBottom">
      <div class="ad-label">
        <i class="material-icons-round">recommend</i>
        OFERTA ESPECIAL
      </div>
      <div class="ad-slot" id="adSlotBottom">
        <div class="ad-placeholder">
          <i class="material-icons-round">savings</i>
          <span>Oportunidade exclusiva</span>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Footer Premium -->
  <footer>
    <div class="footer-content">
      <img src="favicon.png" alt="PagCerto Logo" style="width:60px;height:60px;margin-bottom:1rem;filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));">
      
      <div class="footer-links">
        <a href="#sobre">Sobre</a>
        <a href="#como-funciona">Como Funciona</a>
        <a href="#termos">Termos de Uso</a>
        <a href="#privacidade">Política de Privacidade</a>
        <a href="#contato">Contato</a>
      </div>
      
      <div class="copyright">
        &copy; <span id="currentYear">2025</span> PagCerto - Todos os direitos reservados
      </div>
    </div>
  </footer>

  <!-- Bibliotecas JS -->
  <script src="https://cdn.jsdelivr.net/npm/cleave.js@1.6.0/dist/cleave.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script>
    // Atualizar ano no footer
    document.getElementById('currentYear').textContent = new Date().getFullYear();
    
    // Toggle campo "Outra"
    const nSelect = document.getElementById('n_select');
    const labelNCustom = document.getElementById('label_n_custom');
    function toggleNCustom() {
      labelNCustom.classList.toggle('hidden', nSelect.value !== 'other');
    }
    nSelect.addEventListener('change', toggleNCustom);
    
    // Formatação com Cleave.js
    new Cleave('#v0', { 
      numeral: true, 
      numeralDecimalMark: ',', 
      delimiter: '.', 
      numeralDecimalScale: 2, 
      numeralThousandsGroupStyle: 'thousand' 
    });
    
    new Cleave('#p', { 
      numeral: true, 
      numeralDecimalMark: ',', 
      delimiter: '.', 
      numeralDecimalScale: 2, 
      numeralThousandsGroupStyle: 'thousand' 
    });
    
    new Cleave('#cdipercent', { 
      numeral: true, 
      numeralDecimalScale: 0, 
      numeralThousandsGroupStyle: 'none',
      onValueChanged: (e) => {
        if (e.target.value && !e.target.value.endsWith('%')) {
          e.target.value = e.target.value + '%';
        }
      }
    });
    
    new Cleave('#n_custom', { 
      numeral: true, 
      numeralDecimalScale: 0, 
      numeralThousandsGroupStyle: 'none' 
    });

    // Buscar CDI atual com cache
    let cdiMensal = 0.012; // Valor padrão (1.2% ao mês)
    
    function loadCDICache() {
      const cache = localStorage.getItem('cdiCache');
      if (cache) {
        const { value, timestamp } = JSON.parse(cache);
        // Se o cache tiver menos de 24 horas
        if (Date.now() - timestamp < 86400000) {
          return value;
        }
      }
      return null;
    }
    
    async function fetchCDI() {
      const el = document.getElementById('cdi_valor');
      const cachedValue = loadCDICache();
      
      if (cachedValue) {
        cdiMensal = cachedValue;
        el.textContent = (cdiMensal * 100).toLocaleString('pt-BR',{ minimumFractionDigits:2 }) + '%';
        return;
      }
      
      el.innerHTML = '<span class="loading"></span>carregando…';
      
      try {
        const resp = await fetch('https://api.bcb.gov.br/dados/serie/bcdata.sgs.12/dados/ultimos/1?formato=json');
        if (!resp.ok) throw new Error(resp.status);
        const data = await resp.json();
        const diario = parseFloat(data[0].valor.replace(',', '.')) / 100;
        cdiMensal = Math.pow(1 + diario, 21) - 1;
        
        // Armazenar no localStorage com validade de 1 dia
        localStorage.setItem('cdiCache', JSON.stringify({
          value: cdiMensal,
          timestamp: Date.now()
        }));
        
        el.textContent = (cdiMensal * 100).toLocaleString('pt-BR',{ minimumFractionDigits:2 }) + '%';
      } catch (err) {
        console.error('Erro ao buscar CDI:', err);
        el.textContent = (cdiMensal * 100).toLocaleString('pt-BR',{ minimumFractionDigits:2 }) + '% (padrão)';
      }
    }
    
    // Botão de limpar
    document.getElementById('btnReset').addEventListener('click', () => {
      document.getElementById('v0').value = '';
      document.getElementById('p').value = '';
      document.getElementById('cdipercent').value = '';
      document.getElementById('n_select').value = '';
      document.getElementById('n_custom').value = '';
      
      // Esconder resultados
      ['resCard', 'lineCard', 'barCard', 'donutCard', 'adMiddle', 'adBottom'].forEach(id => {
        document.getElementById(id).classList.add('hidden');
      });
      
      // Foco
      document.getElementById('v0').focus();
    });
    
    // Inicializar ao carregar
    window.addEventListener('load', () => {
      fetchCDI();
      toggleNCustom();
      document.getElementById('v0').focus();
      
      // Inicializar botões do header
      document.getElementById('btnAbout').addEventListener('click', () => {
        alert('PagCerto é uma calculadora financeira premium que ajuda você a decidir entre pagar à vista ou parcelar uma compra, considerando o rendimento do seu dinheiro investido.');
      });
    });

    // Função para formatar valores monetários
    function formatMoney(value) {
      return value.toLocaleString('pt-BR', {
        style: 'currency',
        currency: 'BRL',
        minimumFractionDigits: 2,
        maximumFractionDigits: 2
      });
    }
    
    // Função para mostrar os anúncios
    function showAds() {
      document.getElementById('adMiddle').classList.remove('hidden');
      document.getElementById('adBottom').classList.remove('hidden');
      
      // Simular carregamento de anúncios
      setTimeout(() => {
        document.querySelectorAll('.ad-placeholder').forEach(el => {
          el.innerHTML = '<span style="color:#6b7280">Anúncio carregado</span>';
        });
      }, 1500);
    }

    // Cálculo e geração de gráficos
    document.getElementById('btnCalc').addEventListener('click', () => {
      // Mostrar botão de loading
      const btnCalc = document.getElementById('btnCalc');
      const originalText = btnCalc.innerHTML;
      btnCalc.innerHTML = '<span class="loading"></span>Calculando...';
      btnCalc.disabled = true;
      
      // Atraso intencional para simular processamento
      setTimeout(() => {
        const rawV0 = document.getElementById('v0').value.replace(/\./g,'').replace(',', '.').trim();
        const rawP  = document.getElementById('p').value.replace(/\./g,'').replace(',', '.').trim();
        const rawCDI = document.getElementById('cdipercent').value.replace('%','').trim();
        
        const V0 = parseFloat(rawV0), P = parseFloat(rawP);
        let n = nSelect.value === 'other'
          ? parseInt(document.getElementById('n_custom').value, 10)
          : parseInt(nSelect.value, 10);
        const pct = parseFloat(rawCDI || '100');
        const r = cdiMensal * (pct / 100);
        const resEl = document.getElementById('res');
        
        // Validação dos campos
        if (isNaN(V0) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>Por favor, informe um preço à vista válido.</div>';
          showResults(false);
          resetButton();
          return;
        }
        
        if (V0 <= 0) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>O preço à vista deve ser maior que zero.</div>';
          showResults(false);
          resetButton();
          return;
        }
        
        if (!n || n <= 0) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>Por favor, selecione a quantidade de parcelas.</div>';
          showResults(false);
          resetButton();
          return;
        }
        
        if (isNaN(P)) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>Por favor, informe um valor de parcela válido.</div>';
          showResults(false);
          resetButton();
          return;
        }
        
        if (P <= 0) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>O valor da parcela deve ser maior que zero.</div>';
          showResults(false);
          resetButton();
          return;
        }
        
        if (isNaN(pct)) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>Por favor, informe um percentual de rendimento válido.</div>';
          showResults(false);
          resetButton();
          return;
        }
        
        if (pct <= 0) {
          resEl.innerHTML = '<div class="error"><i class="material-icons-round">error_outline</i>O percentual de rendimento deve ser maior que zero.</div>';
          showResults(false);
          resetButton();
          return;
        }

        // Cálculos principais
        const F = P * n;
        let juros = 0, pago = 0;
        for (let i = 0; i < n; i++) {
          pago += P;
          juros += Math.max(F - pago, 0) * r;
        }
        const CL = F - juros;
        
        // Diferença percentual
        const difValue = Math.abs(CL - V0);
        const difPercent = (difValue / V0) * 100;
        
        // Exibir resultados
        let resultHTML = '';
        
        // Total parcelado
        resultHTML += `
        <div class="result-row">
          <div class="result-label"><i class="material-icons-round">credit_card</i>Total parcelado</div>
          <div class="result-value">${formatMoney(F)}</div>
        </div>`;
        
        // Rendimento total
        resultHTML += `
        <div class="result-row">
          <div class="result-label"><i class="material-icons-round">savings</i>Rendimento</div>
          <div class="result-value">${formatMoney(juros)}</div>
        </div>`;
        
        // Custo líquido
        resultHTML += `
        <div class="result-row">
          <div class="result-label"><i class="material-icons-round">account_balance_wallet</i>Custo líquido</div>
          <div class="result-value">${formatMoney(CL)}</div>
        </div>`;
        
        // Diferença
        resultHTML += `
        <div class="result-row">
          <div class="result-label"><i class="material-icons-round">compare_arrows</i>Diferença</div>
          <div class="result-value">${formatMoney(difValue)} (${difPercent.toFixed(2)}%)</div>
        </div>`;
        
        // Recomendação
        const isBetterParcelado = CL < V0;
        const savings = isBetterParcelado ? V0 - CL : CL - V0;
        
        resultHTML += `
        <div class="recommendation" style="background:linear-gradient(135deg, ${isBetterParcelado ? '#10b981, #059669' : '#3b82f6, #1e40af'})">
          <i class="material-icons-round">${isBetterParcelado ? 'credit_card' : 'payments'}</i>
          <div class="recommendation-text">
            <h3>${isBetterParcelado ? 'Melhor Parcelar e Investir' : 'Melhor Pagar à Vista'}</h3>
            <p>Você ${isBetterParcelado ? 'economiza' : 'economizaria'} ${formatMoney(savings)} se ${isBetterParcelado ? 'parcelar' : 'pagar à vista'}.</p>
          </div>
        </div>`;
        
        resEl.innerHTML = resultHTML;
        
        // Gerar dados para gráficos
        const saldos = [];
        const meses = [];
        let acumulado = 0;
        for (let i = 1; i <= n; i++) {
          acumulado += Math.max(F - (P * i), 0) * r;
          saldos.push(parseFloat(acumulado.toFixed(2)));
          meses.push(`Mês ${i}`);
        }

        // Configurações comuns dos gráficos
        const fontFamily = "'Roboto', sans-serif";
        const colors = ['#1e40af', '#3b82f6', '#10b981', '#FFB400'];
        const commonOptions = {
          chart: {
            fontFamily: fontFamily,
            toolbar: {
              show: false
            },
            animations: {
              enabled: true,
              easing: 'easeinout',
              speed: 800
            },
            dropShadow: {
              enabled: true,
              opacity: 0.1,
              blur: 3,
              left: 0,
              top: 0
            }
          },
          grid: {
            borderColor: '#e5e7eb',
            strokeDashArray: 4,
            padding: {
              top: 10,
              right: 10,
              bottom: 10,
              left: 10
            },
          },
          tooltip: {
            theme: 'light',
            style: {
              fontFamily: fontFamily
            },
            y: {
              formatter: formatMoney
            }
          },
          legend: {
            fontFamily: fontFamily,
            itemMargin: {
              horizontal: 12,
              vertical: 5
            },
            markers: {
              width: 12,
              height: 12,
              radius: 4
            }
          }
        };

        // Renderizar gráficos
        let lineChart = new ApexCharts(document.querySelector('#chart-line'), {
          ...commonOptions,
          chart: {
            ...commonOptions.chart,
            id: 'line-chart',
            type: 'area',
            height: 350
          },
          series: [{
            name: 'Rendimento Acumulado',
            data: saldos
          }],
          xaxis: {
            categories: meses,
            labels: {
              style: {
                fontFamily: fontFamily
              }
            }
          },
          yaxis: {
            labels: {
              formatter: formatMoney,
              style: {
                fontFamily: fontFamily
              }
            }
          },
          dataLabels: {
            enabled: false
          },
          stroke: {
            curve: 'smooth',
            width: 3
          },
          fill: {
            type: 'gradient',
            gradient: {
              shadeIntensity: 1,
              opacityFrom: 0.7,
              opacityTo: 0.2,
              stops: [0, 90, 100],
              colorStops: [
                {
                  offset: 0,
                  color: colors[1],
                  opacity: 0.8
                },
                {
                  offset: 100,
                  color: colors[1],
                  opacity: 0.2
                }
              ]
            }
          },
          markers: {
            size: 5,
            colors: [colors[1]],
            strokeColors: '#fff',
            strokeWidth: 2,
            hover: {
              size: 7
            }
          },
          colors: [colors[1]]
        });
        lineChart.render();

        let barChart = new ApexCharts(document.querySelector('#chart-bar'), {
          ...commonOptions,
          chart: {
            ...commonOptions.chart,
            id: 'bar-chart',
            type: 'bar',
            height: 350
          },
          series: [
            { name: 'À vista', data: [V0] },
            { name: 'Parcelado (custo líquido)', data: [CL] }
          ],
          xaxis: {
            categories: ['Comparativo'],
            labels: {
              style: {
                fontFamily: fontFamily
              }
            }
          },
          plotOptions: {
            bar: {
              columnWidth: '50%',
              borderRadius: 6,
              dataLabels: {
                position: 'top'
              }
            }
          },
          dataLabels: {
            enabled: true,
            formatter: formatMoney,
            style: {
              fontFamily: fontFamily,
              fontWeight: 500
            },
            offsetY: -20,
          },
          colors: [colors[0], colors[3]],
          states: {
            hover: {
              filter: {
                type: 'darken',
                value: 0.9
              }
            }
          }
        });
        barChart.render();

        let donutChart = new ApexCharts(document.querySelector('#chart-donut'), {
          ...commonOptions,
          chart: {
            ...commonOptions.chart,
            id: 'donut-chart',
            type: 'donut',
            height: 350
          },
          series: [CL, juros],
          labels: ['Capital Líquido', 'Juros Economizados'],
          colors: [colors[0], colors[3]],
          legend: {
            ...commonOptions.legend,
            position: 'bottom'
          },
          dataLabels: {
            enabled: true,
            formatter: function(val) {
              return val.toFixed(1) + '%';
            },
            style: {
              fontFamily: fontFamily,
              fontWeight: 500
            }
          },
          plotOptions: {
            pie: {
              donut: {
                labels: {
                  show: true,
                  name: {
                    show: true,
                    fontFamily: fontFamily,
                    fontSize: '16px',
                    fontWeight: 500
                  },
                  value: {
                    show: true,
                    fontFamily: fontFamily,
                    fontSize: '22px',
                    fontWeight: 600,
                    formatter: formatMoney
                  },
                  total: {
                    show: true,
                    showAlways: true,
                    label: 'Total',
                    fontFamily: fontFamily,
                    fontSize: '16px',
                    fontWeight: 500,
                    formatter: function (w) {
                      const total = w.globals.seriesTotals.reduce((a, b) => a + b, 0);
                      return formatMoney(total);
                    }
                  }
                }
              }
            }
          }
        });
        donutChart.render();

        // Mostrar resultados e anúncios
        showResults(true);
        showAds();
        resetButton();
        
        // Scroll para os resultados
        document.getElementById('resCard').scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }, 800); // Tempo do delay para simulação
      
      function resetButton() {
        btnCalc.innerHTML = originalText;
        btnCalc.disabled = false;
      }
    });
    
    // Controla a exibição dos resultados
    function showResults(show) {
      ['resCard', 'lineCard', 'barCard', 'donutCard'].forEach(id => {
        document.getElementById(id).classList.toggle('hidden', !show);
      });
    }
  </script>
</body>
</html>
